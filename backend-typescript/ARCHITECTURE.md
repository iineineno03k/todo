# アプリケーションアーキテクチャ

## モジュール構造

```
src/
├── app.module.ts           # アプリケーションのルートモジュール
├── main.ts                 # アプリケーションのエントリーポイント
├── common/                 # 共通機能
│   ├── logger/             # ロギング機能
│   │   └── logger.service.ts
│   └── trpc/               # tRPC設定
│       └── trpc.router.ts
└── todo/                   # Todoモジュール
    ├── todo.module.ts      # Todoモジュール定義
    ├── controllers/        # コントローラー層
    │   ├── todo.controller.ts
    │   └── todo.controller.spec.ts
    ├── services/           # サービス層
    │   ├── todo.service.ts
    │   └── todo.service.spec.ts
    ├── repositories/       # リポジトリ層
    │   └── todo.repository.ts
    ├── entities/           # エンティティ
    │   └── todo.entity.ts
    └── dtos/               # データ転送オブジェクト
        ├── create-todo.dto.ts
        └── update-todo.dto.ts
```

## レイヤードアーキテクチャ

このアプリケーションはレイヤードアーキテクチャに従って構築されています：

1. **コントローラー層**: HTTPリクエストを処理し、クライアントとのインターフェースを提供します。
2. **サービス層**: ビジネスロジックを実装し、コントローラーとリポジトリの間に位置します。
3. **リポジトリ層**: データアクセスロジックを実装し、Prismaを使用してデータベースと通信します。
4. **エンティティ/DTOs**: データモデルとバリデーションを定義します。

## データフロー

1. クライアントからのHTTPリクエスト
2. コントローラーがリクエストを受信
3. DTOを使用してリクエストデータをバリデーション
4. サービス層でビジネスロジックを実行
5. リポジトリ層でデータベース操作を実行
6. レスポンスをクライアントに返す

## 特徴

### REST API

標準的なRESTful APIを提供し、Todoリソースに対するCRUD操作をサポートします。

### tRPC

型安全なRPCを提供し、フロントエンドとバックエンド間の強力な型チェックを可能にします。

### バリデーション

Zodを使用してリクエストデータのバリデーションを行います。

### ロギング

Pinoを使用して構造化ロギングを実装し、アプリケーションの動作を監視します。

### テスト

Jestを使用したユニットテストとE2Eテストを提供し、コードの品質と信頼性を確保します。 